!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).video||(t.video={})).jsChromecast=e()}}(function(){return(function e(t,i,a){function s(o,n){if(!i[o]){if(!t[o]){var c="function"==typeof require&&require;if(!n&&c)return c(o,!0);if(r)return r(o,!0);var d=Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[o]={exports:{}};t[o][0].call(u.exports,function(e){var i;return s(t[o][1][e]||e)},u,u.exports,e,t,i,a)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<a.length;o++)s(a[o]);return s})({1:[function(e,t,i){(function(e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}}();var a=function e(t,i,a){var s=!0;_function:for(;s;){var r=t,o=i,n=a;s=!1,null===r&&(r=Function.prototype);var c=Object.getOwnPropertyDescriptor(r,o);if(void 0===c){var d=Object.getPrototypeOf(r);if(null===d)return;t=d,i=o,a=n,s=!0,c=d=void 0;continue _function}if("value"in c)return c.value;var u=c.get;if(void 0===u)return;return u.call(n)}};function s(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o,n=(o="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null)&&o.__esModule?o:{default:o},c=n.default.getComponent("Component"),d=n.default.getComponent("ControlBar"),u=n.default.getComponent("Button"),l=!1;class p extends u{constructor(e,t){super(e,t);var i=this;this.hide(),this.initializeApi(),t.appId=e.options_.chromecast.appId,e.chromecast=this,this.on(e,"loadstart",function(){i.casting&&i.apiInitialized&&i.onSessionSuccess(i.apiSession)}),this.on(e,"dispose",function(){i.casting&&i.apiSession&&i.apiSession.stop(null,null)})}initializeApi(){var e=void 0,t=void 0,i=void 0;if(n.default.browser.IS_CHROME&&!n.default.browser.IS_EDGE){if(!chrome.cast||!chrome.cast.isAvailable){n.default.log("Cast APIs not available"),this.tryingReconnect<10&&(this.setTimeout(this.initializeApi,1e3),++this.tryingReconnect),n.default.log("Cast APIs not available. Max reconnect attempt");return}return n.default.log("Cast APIs are available"),t=this.options_.appId||chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,i=new chrome.cast.SessionRequest(t),e=new chrome.cast.ApiConfig(i,this.sessionJoinedListener.bind(this),this.receiverListener.bind(this)),chrome.cast.initialize(e,this.onInitSuccess.bind(this),this.castError.bind(this))}}castError(e){var t={code:e.code,message:e.description};switch(e.code){case chrome.cast.ErrorCode.API_NOT_INITIALIZED:case chrome.cast.ErrorCode.EXTENSION_MISSING:case chrome.cast.ErrorCode.EXTENSION_NOT_COMPATIBLE:case chrome.cast.ErrorCode.INVALID_PARAMETER:case chrome.cast.ErrorCode.LOAD_MEDIA_FAILED:case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:case chrome.cast.ErrorCode.SESSION_ERROR:case chrome.cast.ErrorCode.CHANNEL_ERROR:case chrome.cast.ErrorCode.TIMEOUT:this.addClass("error");break;case chrome.cast.ErrorCode.CANCEL:break;default:this.player_.error(t)}return n.default.log("Cast Error: "+JSON.stringify(e))}onInitSuccess(){return l?this.show():this.hide(),this.apiInitialized=!0}sessionJoinedListener(e){return e.media.length&&(this.apiSession=e,this.onMediaDiscovered(e.media[0])),console.log("Session joined")}receiverListener(e){return"available"===e?(l=!0,this.show()):(l=!1,this.hide())}doLaunch(){return(n.default.log("Cast video: "+this.player_.cache_.src),this.apiInitialized)?chrome.cast.requestSession(this.onSessionSuccess.bind(this),this.castError.bind(this)):n.default.log("Session not initialized")}onSessionSuccess(e){var t=void 0,i=void 0,a=void 0,s=void 0,r=void 0,o=void 0;this.apiSession=e;var c=this.player_.cache_.src,d=this.player_.currentType();if(n.default.log("Session initialized: "+e.sessionId+" source : "+c+" type : "+d),(s=new chrome.cast.media.MediaInfo(c,d)).metadata=new chrome.cast.media.GenericMediaMetadata,this.options_.playerOptions.chromecast.metadata)for(i in r=this.options_.playerOptions.chromecast.metadata)o=r[i],s.metadata[i]=o;var u=this.player().poster();u&&(t=new chrome.cast.Image(u),s.metadata.images=[t]);var l=this.player().textTracks(),p=this.player().remoteTextTrackEls(),h=[],f=0,v=void 0,y=void 0,m=0,g=void 0;if(l){for(f=0;f<l.length;f++)y=l.tracks_[f],v=p&&p.trackElements_&&p.trackElements_[f],m++,(g=new chrome.cast.media.Track(m,chrome.cast.media.TrackType.TEXT)).trackContentId=v?v.src:"caption_"+y.language,g.subtype=chrome.cast.media.TextTrackType.CAPTIONS,g.name=y.label,g.language=y.language,g.customData=null,h.push(g);s.textTrackStyle=new chrome.cast.media.TextTrackStyle,s.textTrackStyle.foregroundColor="#FFFFFF",s.textTrackStyle.backgroundColor="#00000060",s.textTrackStyle.edgeType=chrome.cast.media.TextTrackEdgeType.DROP_SHADOW,s.textTrackStyle.windowType=chrome.cast.media.TextTrackWindowType.ROUNDED_CORNERS}try{if(l=this.player().audioTracks())for(f=0;f<l.length;f++)y=l.tracks_[f],m++,(g=new chrome.cast.media.Track(m,chrome.cast.media.TrackType.AUDIO)).subtype=null,g.name=y.label,g.language=y.language,g.customData=null,h.push(g)}catch(S){n.default.log("get player audioTracks fail"+S)}h.length&&(s.tracks=h),(a=new chrome.cast.media.LoadRequest(s)).autoplay=!0,a.currentTime=this.player_.currentTime(),this.apiSession.loadMedia(a,this.onMediaDiscovered.bind(this),this.castError.bind(this)),this.apiSession.addUpdateListener(this.onSessionUpdate.bind(this))}onMediaDiscovered(e){this.player_.loadTech_("Chromecast",{type:"cast",apiMedia:e,apiSession:this.apiSession}),this.casting=!0,this.inactivityTimeout=this.player_.options_.inactivityTimeout,this.player_.options_.inactivityTimeout=0,this.player_.userActive(!0),this.addClass("connected"),this.removeClass("error")}onSessionUpdate(e){if(this.player_.apiMedia&&!e)return this.onStopAppSuccess()}stopCasting(){return this.apiSession.stop(this.onStopAppSuccess.bind(this),this.castError.bind(this))}onStopAppSuccess(){this.casting=!1;var e=this.player_.currentTime();return this.removeClass("connected"),this.player_.src(this.player_.options_.sources),this.player_.paused()||this.player_.one("seeked",function(){return this.player_.play()}),this.player_.currentTime(e),this.player_.options_.inactivityTimeout=this.inactivityTimeout,this.apiSession=null}buildCSSClass(){return"vjs-chromecast-button "+a(Object.getPrototypeOf(p.prototype),"buildCSSClass",this).call(this)}handleClick(){return(a(Object.getPrototypeOf(p.prototype),"handleClick",this).call(this),this.casting)?this.stopCasting():this.doLaunch()}}p.prototype.tryingReconnect=0,p.prototype.inactivityTimeout=2e3,p.prototype.controlText_="Chromecast",d.prototype.options_.children.splice(d.prototype.options_.children.length-1,0,"chromeCastButton"),c.registerComponent("ChromeCastButton",p),i.default=p,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){(function(e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}}();var a=function e(t,i,a){var s=!0;_function:for(;s;){var r=t,o=i,n=a;s=!1,null===r&&(r=Function.prototype);var c=Object.getOwnPropertyDescriptor(r,o);if(void 0===c){var d=Object.getPrototypeOf(r);if(null===d)return;t=d,i=o,a=n,s=!0,c=d=void 0;continue _function}if("value"in c)return c.value;var u=c.get;if(void 0===u)return;return u.call(n)}};function s(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o,n=(o="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null)&&o.__esModule?o:{default:o};n.default.getComponent("Component");var c=n.default.getComponent("Tech");class d extends c{constructor(e,t){super(e,t);var i,a,s,r=this;r.apiMedia=r.options_.source.apiMedia,r.apiSession=r.options_.source.apiSession,r.receiver=r.apiSession.receiver.friendlyName;var o=r.onMediaStatusUpdate.bind(r),c=r.onSessionUpdate.bind(r);r.apiMedia.addUpdateListener(o),r.apiSession.addUpdateListener(c),this.on("dispose",function(){r.apiMedia.removeUpdateListener(o),r.apiSession.removeUpdateListener(c),r.onMediaStatusUpdate(),r.onSessionUpdate(!1)});var d=r.textTracks();d&&(i=r.handleTextTracksChange.bind(r),d.addEventListener("change",i),r.on("dispose",function(){d.removeEventListener("change",i)}),r.handleTextTracksChange());try{(d=r.audioTracks())&&(a=r.handleAudioTracksChange.bind(r),d.addEventListener("change",a),r.on("dispose",function(){d.removeEventListener("change",a)}))}catch(u){n.default.log("get player audioTracks fail"+u)}try{(d=r.videoTracks())&&(s=r.handleVideoTracksChange.bind(r),d.addEventListener("change",s),r.on("dispose",function(){d.removeEventListener("change",s)}))}catch(l){n.default.log("get player videoTracks fail"+l)}r.update(),r.triggerReady()}createEl(){return n.default.dom.createEl("div",{id:this.options_.techId,className:"vjs-tech vjs-tech-chromecast"})}update(){this.el_.innerHTML='<div class="casting-image" style="background-image: url(\''+this.options_.poster+'\')"></div><div class="casting-overlay"><div class="casting-information"><div class="casting-icon"></div><div class="casting-description"><small>'+this.localize("CASTING TO")+"</small><br>"+this.receiver+"</div></div></div>"}onSessionUpdate(e){if(this.apiMedia&&!e)return this.onStopAppSuccess()}onStopAppSuccess(){this.stopTrackingCurrentTime(),this.apiMedia=null}onMediaStatusUpdate(){if(this.apiMedia)switch(this.apiMedia.playerState){case chrome.cast.media.PlayerState.BUFFERING:this.trigger("waiting");break;case chrome.cast.media.PlayerState.IDLE:this.trigger("timeupdate"),this.trigger("ended");break;case chrome.cast.media.PlayerState.PAUSED:this.trigger("pause"),this.paused_=!0;break;case chrome.cast.media.PlayerState.PLAYING:this.trigger("play"),this.paused_=!1}}src(e){}currentSrc(){if(this.apiMedia)return this.apiMedia.media.contentId}handleAudioTracksChange(){var e=[],t=this.textTracks(),i=this.audioTracks();if(i){for(var a=0;a<i.length;a++)i[a].enabled&&e.push(a+1+t.length);if(this.apiMedia&&e.length)return this.tracksInfoRequest=new chrome.cast.media.EditTracksInfoRequest(e),this.apiMedia.editTracksInfo(this.tracksInfoRequest,this.onTrackSuccess.bind(this),this.onTrackError.bind(this))}}handleVideoTracksChange(){}handleTextTracksChange(){var e=[],t=this.textTracks();if(t){for(var i=0;i<t.length;i++)"showing"===t[i].mode&&e.push(i+1);if(this.apiMedia&&e.length)return this.tracksInfoRequest=new chrome.cast.media.EditTracksInfoRequest(e),this.apiMedia.editTracksInfo(this.tracksInfoRequest,this.onTrackSuccess.bind(this),this.onTrackError.bind(this))}}onTrackSuccess(){return n.default.log("track added")}onTrackError(e){return n.default.log("Cast track Error: "+JSON.stringify(e))}castError(e){return n.default.log("Cast Error: "+JSON.stringify(e))}play(){if(this.apiMedia)return this.paused_&&this.apiMedia.play(null,this.mediaCommandSuccessCallback.bind(this,"Playing: "+this.apiMedia.sessionId),this.castError.bind(this)),this.paused_=!1}pause(){if(this.apiMedia&&!this.paused_)return this.apiMedia.pause(null,this.mediaCommandSuccessCallback.bind(this,"Paused: "+this.apiMedia.sessionId),this.castError.bind(this)),this.paused_=!0}paused(){return this.paused_}ended(){return"FINISHED"===chrome.cast.media.IdleReason}currentTime(){return this.apiMedia?this.apiMedia.getEstimatedTime():0}setCurrentTime(e){if(!this.apiMedia)return 0;var t=void 0;return(t=new chrome.cast.media.SeekRequest).currentTime=e,this.apiMedia.seek(t,this.onSeekSuccess.bind(this,e),this.castError.bind(this))}onSeekSuccess(e){n.default.log("seek success"+e)}volume(){return this.volume_}duration(){return this.apiMedia?this.apiMedia.media.duration||1/0:0}controls(){return!1}setVolume(e){var t=!(arguments.length<=1)&&void 0!==arguments[1]&&arguments[1],i=void 0,a=void 0;if(this.apiMedia)return(a=new chrome.cast.Volume).level=e,a.muted=t,this.volume_=a.level,this.muted_=t,(i=new chrome.cast.media.VolumeRequest).volume=a,this.apiMedia.setVolume(i,this.mediaCommandSuccessCallback.bind(this,"Volume changed"),this.castError.bind(this)),this.trigger("volumechange")}mediaCommandSuccessCallback(e){n.default.log(e)}muted(){return this.muted_}setMuted(e){return this.setVolume(this.volume_,e)}supportsFullScreen(){return!1}resetSrc_(e){e()}dispose(){this.resetSrc_(Function.prototype),a(Object.getPrototypeOf(d.prototype),"dispose",this).call(this,this)}}d.prototype.paused_=!1,d.prototype.options_={},d.prototype.timerStep=1e3,d.isSupported=function(){return!0},c.withSourceHandlers(d),d.nativeSourceHandler={},d.nativeSourceHandler.canPlayType=function(e){return/^application\/(?:dash\+xml|(x-|vnd\.apple\.)mpegurl)/i.test(e)?"probably":/^video\/(mpd|mp4|webm|m3u8)/i.test(e)?"maybe":""},d.nativeSourceHandler.canHandleSource=function(e){return e.type?d.nativeSourceHandler.canPlayType(e.type):e.src?d.nativeSourceHandler.canPlayType(e.src):""},d.nativeSourceHandler.handleSource=function(e,t){t.src(e.src)},d.nativeSourceHandler.dispose=function(){},d.registerSourceHandler(d.nativeSourceHandler),d.prototype.featuresVolumeControl=!0,d.prototype.featuresPlaybackRate=!1,d.prototype.movingMediaElementInDOM=!1,d.prototype.featuresFullscreenResize=!1,d.prototype.featuresTimeupdateEvents=!1,d.prototype.featuresProgressEvents=!1,d.prototype.featuresNativeTextTracks=!0,d.prototype.featuresNativeAudioTracks=!0,d.prototype.featuresNativeVideoTracks=!1,n.default.options.chromecast={},c.registerTech("Chromecast",d),i.default=d,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,i){(function(a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var n,c,d=s("undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null);s(e("./component/control-bar/chromecast-button")),s(e("./tech/chromecast"));var u=d.default.getComponent("Component");class l extends u{constructor(e,t){super(e,t)}}l.prototype.options_={},d.default.options.children.push("chromecast"),d.default.addLanguage("en",{"CASTING TO":"WIEDERGABE AUF"}),d.default.addLanguage("de",{"CASTING TO":"WIEDERGABE AUF"}),d.default.addLanguage("it",{"CASTING TO":"PLAYBACK SU"}),d.default.addLanguage("fr",{"CASTING TO":"CAST EN COURS SUR"}),u.registerComponent("Chromecast",l),i.default=l,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./component/control-bar/chromecast-button":1,"./tech/chromecast":2}],4:[function(e,t,i){(function(a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var r,o=s("undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null);s(e("./videojs-chromecast"));var n=function e(t){this.addChild("Chromecast",t)};(o.default.registerPlugin||o.default.plugin)("chromecast",n),i.default=n,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./videojs-chromecast":3}]},{},[4])(4)});